/* Copyright 2020 ZSA Technology Labs, Inc <@zsa>
 * Copyright 2020 Jack Humbert <jack.humb@gmail.com>
 * Copyright 2020 Christopher Courtney, aka Drashna Jael're  (@drashna) <drashna@live.com>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */



#include "action.h"
#include "action_code.h"
#include "action_util.h"
#include "keycode.h"
#include "quantum_keycodes.h"
#include QMK_KEYBOARD_H
#include "version.h"

enum layers {
    _BASE,  // default layer
    _LOWER,    // navigation
    _RAISE, // mouse
    _ADJUST,  // symbols
};

#define LOWER MO(_LOWER)
#define RAISE MO(_RAISE)

#define OSM_LCTL OSM(MOD_LCTL)
#define OSM_LSFT OSM(MOD_LSFT)
#define OSM_HYPR OSM(MOD_HYPR)

#define LT_SPC LT(_LOWER, KC_SPC)
#define LT_BSPC LT(_RAISE, KC_BSPC)
#define LT_ESC LGUI_T(KC_ESC)

// clang-format off
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
/* ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐ ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐
 * │  ESC  │  1  │  2  │  3  │  4  │  5  │       │ │       │  6  │  7  │  8  │  9  │  0  │ EQUAL │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │  TAB  │  Q  │  W  │  E  │  R  │  T  │       │ │       │  Y  │  U  │  I  │  O  │  P  │ MINUS │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │ LCTL  │  A  │  S  │  D  │  F  │  G  │OSM_HYP│ │OSM_HYP│  H  │  J  │  K  │  L  │ : ; │  ' "  │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┘ └───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │ LSFT  │  Z  │  X  │  C  │  V  │  B  │                 │  N  │  M  │ , < │ . > │ / ? │ GRAVE │
 * ├───────┼─────┼─────┼─────┼─────┼─────┘                 └─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │ L⎇  │LT_ES│LT_SP│                             │LT_BS│LSFT │     │     │       │
 * └───────┴─────┴─────┴─────┴─────┘                             └─────┴─────┴─────┴─────┴───────┘
 *                               ┌───────────────┐ ┌───────────────┐
 *                               │               │ │     CAPS      │
 *                       ┌───────┼───────┬───────┤ ├───────┬───────┼───────┐
 *                       │LALT(KC│       │       │ │       │       │ ENTER │
 *                       └───────┴───────┴───────┘ └───────┴───────┴───────┘
 *                                                                      generated by [keymapviz] */
    [_BASE] = LAYOUT_moonlander(
        KC_ESC,    KC_1,     KC_2,      KC_3,      KC_4,        KC_5,  _______,       _______,  KC_6,  KC_7,       KC_8,     KC_9,    KC_0,    KC_EQUAL,
        KC_TAB,    KC_Q,     KC_W,      KC_E,      KC_R,        KC_T,  _______,       _______,  KC_Y,  KC_U,       KC_I,     KC_O,    KC_P,    KC_MINUS,
        OSM_LCTL,  KC_A,     KC_S,      KC_D,      KC_F,        KC_G,  OSM_HYPR,      OSM_HYPR, KC_H,  KC_J,       KC_K,     KC_L,    KC_SCLN, KC_QUOT,
        OSM_LSFT,  KC_Z,     KC_X,      KC_C,      KC_V,        KC_B,                           KC_N,  KC_M,       KC_COMM,  KC_DOT,  KC_SLSH, KC_GRAVE,
        _______,   _______,  KC_LALT,   LT_ESC,    LT_SPC,             _______,       KC_CAPS,         LT_BSPC,    OSM_LSFT, _______, _______, _______,
                                              LALT(KC_SPC),  _______,  _______,       _______,  _______,  KC_ENTER
    ),
/* ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐ ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐
 * │       │     │     │     │     │     │       │ │       │     │     │     │     │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │  !  │  @  │  #  │  $  │  %  │       │ │       │  ^  │  &  │  *  │  (  │  )  │   |   │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │  1  │  2  │  3  │  4  │  5  │       │ │       │  ◁  │  ▽  │  △  │  ▷  │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┘ └───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │  ~  │  `  │  (  │  [  │  {  │                 │  }  │  ]  │  )  │VOLD │VOLU │ MUTE  │
 * ├───────┼─────┼─────┼─────┼─────┼─────┘                 └─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │     │     │     │                             │     │     │     │     │       │
 * └───────┴─────┴─────┴─────┴─────┘                             └─────┴─────┴─────┴─────┴───────┘
 *                               ┌───────────────┐ ┌───────────────┐
 *                               │               │ │               │
 *                       ┌───────┼───────┬───────┤ ├───────┬───────┼───────┐
 *                       │       │       │       │ │       │       │ MPLY  │
 *                       └───────┴───────┴───────┘ └───────┴───────┴───────┘
 *                                                                      generated by [keymapviz] */
    [_LOWER] = LAYOUT_moonlander(
        _______,  _______, _______, _______, _______, _______,  _______,                                _______, _______,  _______,    _______, _______,  _______, _______,
        _______,  KC_EXLM, KC_AT,   KC_HASH, KC_DLR,  KC_PERC,  _______,                                _______, KC_CIRC,  KC_AMPR,   KC_ASTR, KC_LPRN,  KC_RPRN, KC_PIPE,
        _______,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,     _______,                                _______, KC_LEFT,  KC_DOWN,   KC_UP,   KC_RIGHT, _______, _______,
        _______,  KC_TILD,  KC_GRV, KC_LPRN, KC_LBRC, KC_LCBR,                                                   KC_RCBR,  KC_RBRC,   KC_RPRN, KC_VOLD,  KC_VOLU,  KC_MUTE,
        _______,  _______, _______, _______, _______,             _______,                                _______,           _______,  _______, _______,  _______, _______,
                                            _______,  _______,  _______,                                _______, _______,  KC_MPLY
    ),
/* ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐ ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐
 * │       │     │     │     │     │     │       │ │       │     │     │     │     │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │ F1  │ F2  │ F3  │ F4  │ F5  │  F11  │ │  F12  │ F6  │ F7  │ F8  │ F9  │ F10 │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │  1  │  2  │  3  │  4  │  5  │       │ │       │  6  │  7  │  8  │  9  │  0  │ COLON │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┘ └───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │  ~  │  `  │  (  │  [  │  {  │                 │  }  │  ]  │  )  │     │ \ | │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┘                 └─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │     │     │     │                             │     │     │     │     │       │
 * └───────┴─────┴─────┴─────┴─────┘                             └─────┴─────┴─────┴─────┴───────┘
 *                               ┌───────────────┐ ┌───────────────┐
 *                               │               │ │               │
 *                       ┌───────┼───────┬───────┤ ├───────┬───────┼───────┐
 *                       │       │       │       │ │       │       │       │
 *                       └───────┴───────┴───────┘ └───────┴───────┴───────┘
 *                                                                      generated by [keymapviz] */
    [_RAISE] = LAYOUT_moonlander(
        _______,  _______, _______, _______, _______, _______, _______,                               _______, _______, _______, _______, _______, _______,   _______,
        _______,  KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,   KC_F11,                                KC_F12,  KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,    _______,
        _______,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,    _______,                               _______, KC_6,    KC_7,    KC_8,    KC_9,    KC_0,      KC_COLON,
        _______,  KC_TILD, KC_GRV,  KC_LPRN, KC_LBRC, KC_LCBR,                                                 KC_RCBR, KC_RBRC, KC_RPRN, _______, KC_BSLASH, _______,
        _______,  _______, _______, _______, _______,           _______,                                       _______, _______,   _______, _______, _______, _______,
                           _______,  _______,  _______,                                              _______,  _______, _______
    ),
/* ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐ ┌───────┬─────┬─────┬─────┬─────┬─────┬───────┐
 * │       │     │     │     │     │     │       │ │       │     │     │     │     │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │     │     │     │     │       │ │       │     │     │     │     │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤ ├───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │     │     │     │     │       │ │       │     │     │     │     │     │       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┼───────┘ └───────┼─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │CAPS │     │     │     │     │                 │     │     │     │     │RESET│       │
 * ├───────┼─────┼─────┼─────┼─────┼─────┘                 └─────┼─────┼─────┼─────┼─────┼───────┤
 * │       │     │     │     │     │                             │     │     │     │     │       │
 * └───────┴─────┴─────┴─────┴─────┘                             └─────┴─────┴─────┴─────┴───────┘
 *                               ┌───────────────┐ ┌───────────────┐
 *                               │               │ │               │
 *                       ┌───────┼───────┬───────┤ ├───────┬───────┼───────┐
 *                       │       │       │       │ │       │       │       │
 *                       └───────┴───────┴───────┘ └───────┴───────┴───────┘
 *                                                                      generated by [keymapviz] */
    [_ADJUST] = LAYOUT_moonlander(
        _______,  _______, _______, _______, _______, _______,  _______,                                _______, _______, _______, _______,  _______, _______, _______,
        _______,  _______, _______, _______, _______, _______,  _______,                                _______, _______, _______, _______,  _______, _______, _______,
        _______,  _______, _______, _______, _______, _______,  _______,                                _______, _______, _______, _______,  _______, _______, _______,
        _______,  KC_CAPS, _______, _______, _______, _______,                                                   _______, _______, _______,  _______, RESET,   _______,
        _______,  _______, _______, _______, _______, _______,                                                   _______, _______, _______,  _______, _______, _______,
                                            _______,  _______,  _______,                                _______, _______, _______
    ),
};

layer_state_t layer_state_set_user(layer_state_t state) {
  return update_tri_layer_state(state, _LOWER, _RAISE, _ADJUST);
}
